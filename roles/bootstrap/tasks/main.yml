---

- name: "Install common packages"
  ansible.builtin.package:
    state: present
    name:
      - vim-gtk3
      - tmux
      - git
      - silversearcher-ag
      - build-essential
      - gawk
      - stow
      - fasd
      - direnv
      - jq
      - exuberant-ctags
      - shellcheck
        # Needed for tmux-yank
      - xclip
  become: true
  become_method: sudo

- name: Install ubuntu specific packages.
  ansible.builtin.package:
    state: present
    name:
      - ubuntu-restricted-extras
      - ppa-purge
  become: true
  become_method: sudo
  when: ansible_facts['os_family']|lower == 'ubuntu'

- name: Setup .local file structure
  file:
    path: "~/.local/{{item}}"
    state: directory
  loop:
    - bin
    - var
    - etc
    - lib
    - share

- name: "Enable sysreq magic keys"
  become: true
  ansible.builtin.copy:
    content: |
      kernel.sysrq=1
    dest: /etc/sysctl.d/90-sysrq.conf
    owner: root
    group: root
    mode: '0644'
